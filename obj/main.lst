                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.6.8 #9946 (Linux)
                              4 ;--------------------------------------------------------
                              5 	.module main
                              6 	.optsdcc -mz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _main
                             12 	.globl _initSprites
                             13 	.globl _draw_sp_vshot
                             14 	.globl _draw_sp_enemy_saucer
                             15 	.globl _draw_sp_player
                             16 	.globl _drawSprite
                             17 	.globl _cpct_getScreenPtr
                             18 	.globl _cpct_setPALColour
                             19 	.globl _cpct_setPalette
                             20 	.globl _cpct_waitVSYNC
                             21 	.globl _cpct_setVideoMode
                             22 	.globl _cpct_drawSprite
                             23 	.globl _cpct_isKeyPressed
                             24 	.globl _cpct_scanKeyboard
                             25 	.globl _cpct_disableFirmware
                             26 	.globl _sp_enemy_saucer_speed
                             27 	.globl _sp_enemy_saucer_y
                             28 	.globl _sp_enemy_saucer_x
                             29 	.globl _sp_vshot_y_speed
                             30 	.globl _sp_vshot_y
                             31 	.globl _sp_vshot_x
                             32 	.globl _sp_player_ship_speed
                             33 	.globl _sp_player_ship_y
                             34 	.globl _sp_player_ship_x
                             35 ;--------------------------------------------------------
                             36 ; special function registers
                             37 ;--------------------------------------------------------
                             38 ;--------------------------------------------------------
                             39 ; ram data
                             40 ;--------------------------------------------------------
                             41 	.area _DATA
   0000                      42 _sp_player_ship_x::
   0000                      43 	.ds 1
   0001                      44 _sp_player_ship_y::
   0001                      45 	.ds 1
   0002                      46 _sp_player_ship_speed::
   0002                      47 	.ds 1
   0003                      48 _sp_vshot_x::
   0003                      49 	.ds 1
   0004                      50 _sp_vshot_y::
   0004                      51 	.ds 1
   0005                      52 _sp_vshot_y_speed::
   0005                      53 	.ds 1
   0006                      54 _sp_enemy_saucer_x::
   0006                      55 	.ds 1
   0007                      56 _sp_enemy_saucer_y::
   0007                      57 	.ds 1
   0008                      58 _sp_enemy_saucer_speed::
   0008                      59 	.ds 1
                             60 ;--------------------------------------------------------
                             61 ; ram data
                             62 ;--------------------------------------------------------
                             63 	.area _INITIALIZED
                             64 ;--------------------------------------------------------
                             65 ; absolute external ram data
                             66 ;--------------------------------------------------------
                             67 	.area _DABS (ABS)
                             68 ;--------------------------------------------------------
                             69 ; global & static initialisations
                             70 ;--------------------------------------------------------
                             71 	.area _HOME
                             72 	.area _GSINIT
                             73 	.area _GSFINAL
                             74 	.area _GSINIT
                             75 ;--------------------------------------------------------
                             76 ; Home
                             77 ;--------------------------------------------------------
                             78 	.area _HOME
                             79 	.area _HOME
                             80 ;--------------------------------------------------------
                             81 ; code
                             82 ;--------------------------------------------------------
                             83 	.area _CODE
                             84 ;src/main.c:50: void drawSprite(u8 *sprite,int x,int y,int sprite_width,int sprite_height)
                             85 ;	---------------------------------
                             86 ; Function drawSprite
                             87 ; ---------------------------------
   0000                      88 _drawSprite::
   0000 DD E5         [15]   89 	push	ix
   0002 DD 21 00 00   [14]   90 	ld	ix,#0
   0006 DD 39         [15]   91 	add	ix,sp
                             92 ;src/main.c:53: pvmem = cpct_getScreenPtr(CPCT_VMEM_START,x,y);
   0008 DD 56 08      [19]   93 	ld	d, 8 (ix)
   000B DD 5E 06      [19]   94 	ld	e, 6 (ix)
   000E D5            [11]   95 	push	de
   000F 21 00 C0      [10]   96 	ld	hl, #0xc000
   0012 E5            [11]   97 	push	hl
   0013 CDr00r00      [17]   98 	call	_cpct_getScreenPtr
   0016 EB            [ 4]   99 	ex	de,hl
                            100 ;src/main.c:54: cpct_drawSprite(sprite,pvmem,sprite_width,sprite_height);
   0017 DD 66 0C      [19]  101 	ld	h, 12 (ix)
   001A DD 4E 0A      [19]  102 	ld	c, 10 (ix)
   001D DD 6E 04      [19]  103 	ld	l, 4 (ix)
   0020 DD 46 05      [19]  104 	ld	b, 5 (ix)
   0023 E5            [11]  105 	push	hl
   0024 33            [ 6]  106 	inc	sp
   0025 79            [ 4]  107 	ld	a, c
   0026 F5            [11]  108 	push	af
   0027 33            [ 6]  109 	inc	sp
   0028 D5            [11]  110 	push	de
   0029 60            [ 4]  111 	ld	h, b
   002A E5            [11]  112 	push	hl
   002B CDr00r00      [17]  113 	call	_cpct_drawSprite
   002E DD E1         [14]  114 	pop	ix
   0030 C9            [10]  115 	ret
                            116 ;src/main.c:58: void draw_sp_player(u8 x,u8 y)
                            117 ;	---------------------------------
                            118 ; Function draw_sp_player
                            119 ; ---------------------------------
   0031                     120 _draw_sp_player::
   0031 DD E5         [15]  121 	push	ix
   0033 DD 21 00 00   [14]  122 	ld	ix,#0
   0037 DD 39         [15]  123 	add	ix,sp
                            124 ;src/main.c:60: drawSprite (sp_player_ship,x,y,SP_PLAYER_SHIP_W,SP_PLAYER_SHIP_H);
   0039 DD 5E 05      [19]  125 	ld	e, 5 (ix)
   003C 16 00         [ 7]  126 	ld	d, #0x00
   003E DD 4E 04      [19]  127 	ld	c, 4 (ix)
   0041 06 00         [ 7]  128 	ld	b, #0x00
   0043 21 0E 00      [10]  129 	ld	hl, #0x000e
   0046 E5            [11]  130 	push	hl
   0047 2E 06         [ 7]  131 	ld	l, #0x06
   0049 E5            [11]  132 	push	hl
   004A D5            [11]  133 	push	de
   004B C5            [11]  134 	push	bc
   004C 21r00r00      [10]  135 	ld	hl, #_sp_player_ship
   004F E5            [11]  136 	push	hl
   0050 CDr00r00      [17]  137 	call	_drawSprite
   0053 21 0A 00      [10]  138 	ld	hl, #10
   0056 39            [11]  139 	add	hl, sp
   0057 F9            [ 6]  140 	ld	sp, hl
   0058 DD E1         [14]  141 	pop	ix
   005A C9            [10]  142 	ret
                            143 ;src/main.c:63: void draw_sp_enemy_saucer(u8 x,u8 y)
                            144 ;	---------------------------------
                            145 ; Function draw_sp_enemy_saucer
                            146 ; ---------------------------------
   005B                     147 _draw_sp_enemy_saucer::
   005B DD E5         [15]  148 	push	ix
   005D DD 21 00 00   [14]  149 	ld	ix,#0
   0061 DD 39         [15]  150 	add	ix,sp
                            151 ;src/main.c:65: drawSprite (sp_enemy_saucer,x,y,SP_ENEMY_SAUCER_W,SP_ENEMY_SAUCER_H);
   0063 DD 5E 05      [19]  152 	ld	e, 5 (ix)
   0066 16 00         [ 7]  153 	ld	d, #0x00
   0068 DD 4E 04      [19]  154 	ld	c, 4 (ix)
   006B 06 00         [ 7]  155 	ld	b, #0x00
   006D 21 10 00      [10]  156 	ld	hl, #0x0010
   0070 E5            [11]  157 	push	hl
   0071 2E 0C         [ 7]  158 	ld	l, #0x0c
   0073 E5            [11]  159 	push	hl
   0074 D5            [11]  160 	push	de
   0075 C5            [11]  161 	push	bc
   0076 21r00r00      [10]  162 	ld	hl, #_sp_enemy_saucer
   0079 E5            [11]  163 	push	hl
   007A CDr00r00      [17]  164 	call	_drawSprite
   007D 21 0A 00      [10]  165 	ld	hl, #10
   0080 39            [11]  166 	add	hl, sp
   0081 F9            [ 6]  167 	ld	sp, hl
   0082 DD E1         [14]  168 	pop	ix
   0084 C9            [10]  169 	ret
                            170 ;src/main.c:67: void draw_sp_vshot(u8 x,u8 y)
                            171 ;	---------------------------------
                            172 ; Function draw_sp_vshot
                            173 ; ---------------------------------
   0085                     174 _draw_sp_vshot::
   0085 DD E5         [15]  175 	push	ix
   0087 DD 21 00 00   [14]  176 	ld	ix,#0
   008B DD 39         [15]  177 	add	ix,sp
                            178 ;src/main.c:69: drawSprite (sp_vshot,x,y,SP_VSHOT_W,SP_VSHOT_H);
   008D DD 5E 05      [19]  179 	ld	e, 5 (ix)
   0090 16 00         [ 7]  180 	ld	d, #0x00
   0092 DD 4E 04      [19]  181 	ld	c, 4 (ix)
   0095 06 00         [ 7]  182 	ld	b, #0x00
   0097 21 06 00      [10]  183 	ld	hl, #0x0006
   009A E5            [11]  184 	push	hl
   009B 2E 01         [ 7]  185 	ld	l, #0x01
   009D E5            [11]  186 	push	hl
   009E D5            [11]  187 	push	de
   009F C5            [11]  188 	push	bc
   00A0 21r00r00      [10]  189 	ld	hl, #_sp_vshot
   00A3 E5            [11]  190 	push	hl
   00A4 CDr00r00      [17]  191 	call	_drawSprite
   00A7 21 0A 00      [10]  192 	ld	hl, #10
   00AA 39            [11]  193 	add	hl, sp
   00AB F9            [ 6]  194 	ld	sp, hl
   00AC DD E1         [14]  195 	pop	ix
   00AE C9            [10]  196 	ret
                            197 ;src/main.c:72: void initSprites()
                            198 ;	---------------------------------
                            199 ; Function initSprites
                            200 ; ---------------------------------
   00AF                     201 _initSprites::
                            202 ;src/main.c:74: sp_player_ship_x = (SCREEN_RIGHT/2) - (SP_PLAYER_SHIP_W);
   00AF 21r00r00      [10]  203 	ld	hl,#_sp_player_ship_x + 0
   00B2 36 22         [10]  204 	ld	(hl), #0x22
                            205 ;src/main.c:75: sp_player_ship_y = SCREEN_BOTTOM-SP_PLAYER_SHIP_H;
   00B4 21r01r00      [10]  206 	ld	hl,#_sp_player_ship_y + 0
   00B7 36 BA         [10]  207 	ld	(hl), #0xba
                            208 ;src/main.c:76: draw_sp_player(sp_player_ship_x,sp_player_ship_y);
   00B9 21 22 BA      [10]  209 	ld	hl, #0xba22
   00BC E5            [11]  210 	push	hl
   00BD CDr31r00      [17]  211 	call	_draw_sp_player
   00C0 F1            [10]  212 	pop	af
                            213 ;src/main.c:78: sp_vshot_x = (SCREEN_RIGHT/2) - (SP_PLAYER_SHIP_W/2);
   00C1 21r03r00      [10]  214 	ld	hl,#_sp_vshot_x + 0
   00C4 36 25         [10]  215 	ld	(hl), #0x25
                            216 ;src/main.c:79: sp_vshot_y = SCREEN_BOTTOM - SP_PLAYER_SHIP_H - SP_VSHOT_H;
   00C6 21r04r00      [10]  217 	ld	hl,#_sp_vshot_y + 0
   00C9 36 B4         [10]  218 	ld	(hl), #0xb4
                            219 ;src/main.c:80: draw_sp_vshot(sp_vshot_x,sp_vshot_y);
   00CB 21 25 B4      [10]  220 	ld	hl, #0xb425
   00CE E5            [11]  221 	push	hl
   00CF CDr85r00      [17]  222 	call	_draw_sp_vshot
   00D2 F1            [10]  223 	pop	af
                            224 ;src/main.c:82: sp_enemy_saucer_x = SCREEN_RIGHT - SP_ENEMY_SAUCER_W;
   00D3 21r06r00      [10]  225 	ld	hl,#_sp_enemy_saucer_x + 0
   00D6 36 44         [10]  226 	ld	(hl), #0x44
                            227 ;src/main.c:83: sp_enemy_saucer_y = SCREEN_TOP + SCREEN_FRAME;
   00D8 21r07r00      [10]  228 	ld	hl,#_sp_enemy_saucer_y + 0
   00DB 36 01         [10]  229 	ld	(hl), #0x01
                            230 ;src/main.c:84: sp_enemy_saucer_speed = 1;
   00DD 21r08r00      [10]  231 	ld	hl,#_sp_enemy_saucer_speed + 0
   00E0 36 01         [10]  232 	ld	(hl), #0x01
                            233 ;src/main.c:85: draw_sp_enemy_saucer(sp_enemy_saucer_x,sp_enemy_saucer_y);
   00E2 21 44 01      [10]  234 	ld	hl, #0x0144
   00E5 E5            [11]  235 	push	hl
   00E6 CDr5Br00      [17]  236 	call	_draw_sp_enemy_saucer
   00E9 F1            [10]  237 	pop	af
   00EA C9            [10]  238 	ret
                            239 ;src/main.c:89: void main(void) 
                            240 ;	---------------------------------
                            241 ; Function main
                            242 ; ---------------------------------
   00EB                     243 _main::
                            244 ;src/main.c:98: cpct_disableFirmware();
   00EB CDr00r00      [17]  245 	call	_cpct_disableFirmware
                            246 ;src/main.c:100: cpct_setVideoMode(0);
   00EE 2E 00         [ 7]  247 	ld	l, #0x00
   00F0 CDr00r00      [17]  248 	call	_cpct_setVideoMode
                            249 ;src/main.c:101: cpct_setPalette(g_palette, 16);
   00F3 21 10 00      [10]  250 	ld	hl, #0x0010
   00F6 E5            [11]  251 	push	hl
   00F7 21r00r00      [10]  252 	ld	hl, #_g_palette
   00FA E5            [11]  253 	push	hl
   00FB CDr00r00      [17]  254 	call	_cpct_setPalette
                            255 ;src/main.c:102: cpct_setBorder(HW_BLACK);
   00FE 21 10 14      [10]  256 	ld	hl, #0x1410
   0101 E5            [11]  257 	push	hl
   0102 CDr00r00      [17]  258 	call	_cpct_setPALColour
                            259 ;src/main.c:104: initSprites();
   0105 CDrAFr00      [17]  260 	call	_initSprites
                            261 ;src/main.c:109: while (TRUE)
   0108                     262 00110$:
                            263 ;src/main.c:111: cpct_scanKeyboard();
   0108 CDr00r00      [17]  264 	call	_cpct_scanKeyboard
                            265 ;src/main.c:113: if (cpct_isKeyPressed (Key_P))
   010B 21 03 08      [10]  266 	ld	hl, #0x0803
   010E CDr00r00      [17]  267 	call	_cpct_isKeyPressed
   0111 7D            [ 4]  268 	ld	a, l
   0112 B7            [ 4]  269 	or	a, a
   0113 28 2B         [12]  270 	jr	Z,00104$
                            271 ;src/main.c:115: if (sp_player_ship_x + SP_PLAYER_SHIP_W < SCREEN_RIGHT)
   0115 FD 21r00r00   [14]  272 	ld	iy, #_sp_player_ship_x
   0119 FD 4E 00      [19]  273 	ld	c, 0 (iy)
   011C 06 00         [ 7]  274 	ld	b, #0x00
   011E 21 06 00      [10]  275 	ld	hl, #0x0006
   0121 09            [11]  276 	add	hl, bc
   0122 11 50 80      [10]  277 	ld	de, #0x8050
   0125 29            [11]  278 	add	hl, hl
   0126 3F            [ 4]  279 	ccf
   0127 CB 1C         [ 8]  280 	rr	h
   0129 CB 1D         [ 8]  281 	rr	l
   012B ED 52         [15]  282 	sbc	hl, de
   012D 30 11         [12]  283 	jr	NC,00104$
                            284 ;src/main.c:117: ++sp_player_ship_x;
   012F FD 34 00      [23]  285 	inc	0 (iy)
                            286 ;src/main.c:118: draw_sp_player(sp_player_ship_x,sp_player_ship_y);
   0132 3Ar01r00      [13]  287 	ld	a, (_sp_player_ship_y)
   0135 F5            [11]  288 	push	af
   0136 33            [ 6]  289 	inc	sp
   0137 3Ar00r00      [13]  290 	ld	a, (_sp_player_ship_x)
   013A F5            [11]  291 	push	af
   013B 33            [ 6]  292 	inc	sp
   013C CDr31r00      [17]  293 	call	_draw_sp_player
   013F F1            [10]  294 	pop	af
   0140                     295 00104$:
                            296 ;src/main.c:123: if (cpct_isKeyPressed (Key_O))
   0140 21 04 04      [10]  297 	ld	hl, #0x0404
   0143 CDr00r00      [17]  298 	call	_cpct_isKeyPressed
   0146 7D            [ 4]  299 	ld	a, l
   0147 B7            [ 4]  300 	or	a, a
   0148 28 1B         [12]  301 	jr	Z,00108$
                            302 ;src/main.c:125: if (sp_player_ship_x > SCREEN_LEFT)
   014A FD 21r00r00   [14]  303 	ld	iy, #_sp_player_ship_x
   014E FD 7E 00      [19]  304 	ld	a, 0 (iy)
   0151 B7            [ 4]  305 	or	a, a
   0152 28 11         [12]  306 	jr	Z,00108$
                            307 ;src/main.c:127: --sp_player_ship_x;
   0154 FD 35 00      [23]  308 	dec	0 (iy)
                            309 ;src/main.c:128: draw_sp_player(sp_player_ship_x,sp_player_ship_y);
   0157 3Ar01r00      [13]  310 	ld	a, (_sp_player_ship_y)
   015A F5            [11]  311 	push	af
   015B 33            [ 6]  312 	inc	sp
   015C 3Ar00r00      [13]  313 	ld	a, (_sp_player_ship_x)
   015F F5            [11]  314 	push	af
   0160 33            [ 6]  315 	inc	sp
   0161 CDr31r00      [17]  316 	call	_draw_sp_player
   0164 F1            [10]  317 	pop	af
   0165                     318 00108$:
                            319 ;src/main.c:132: cpct_waitVSYNC();
   0165 CDr00r00      [17]  320 	call	_cpct_waitVSYNC
   0168 18 9E         [12]  321 	jr	00110$
                            322 	.area _CODE
                            323 	.area _INITIALIZER
                            324 	.area _CABS (ABS)
